(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{57103:function(e,t,s){Promise.resolve().then(s.bind(s,63453))},63453:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Home}});var n=s(57437),l=s(20994),a=s(53085),o=s(2265);let i={apiKey:"AIzaSyBE9hIT9pXt_lGR3O7RLWe5xCdC3y_4q-E",authDomain:"travelling-salesman-57720.firebaseapp.com",projectId:"travelling-salesman-57720",storageBucket:"travelling-salesman-57720.appspot.com",messagingSenderId:"38062332553",appId:"1:38062332553:web:dfdd99212870f7ea5c8458",measurementId:"G-GS3VZ1FH88"},c=new a.hJ;function useAuthentication(){let[e,t]=(0,o.useState)(void 0),s=(0,o.useCallback)(()=>{(0,l.ZF)(i)},[]),n=(0,o.useCallback)(()=>{let e=(0,a.v0)();(0,a.rh)(e,c).then(e=>{let s=a.hJ.credentialFromResult(e);s.accessToken;let n=e.user;t(n)}).catch(e=>{e.code,e.message,e.customData.email,a.hJ.credentialFromError(e)})},[]),r=(0,o.useCallback)(()=>{let e=(0,a.v0)();(0,a.w7)(e).then(e=>{t(void 0)}).catch(e=>{alert("Something went wrong on logout ".concat(e)),t(void 0)})},[]);return{signInWithGoogle:n,user:e,initialise:s,signOutFromApp:r}}function evolveOnDistances(e){let Individual=class Individual{calculateFitness(){let t=0;for(let s=0;s<this.chromosome.length-1;s++)t+=e[this.chromosome[s]][this.chromosome[s+1]];return 1/(t+=e[this.chromosome[this.chromosome.length-1]][this.chromosome[0]])}static crossover(e,t){let s=Math.floor(Math.random()*e.chromosome.length),n=Math.floor(Math.random()*e.chromosome.length),l=[];for(let t=0;t<e.chromosome.length;t++)s<n&&t>s&&t<n?l.push(e.chromosome[t]):s>n&&(t<s||t>n)?l.push(e.chromosome[t]):t===s&&l.push(e.chromosome[t]);for(let e=0;e<t.chromosome.length;e++)l.includes(t.chromosome[e])||l.push(t.chromosome[e]);return new Individual(l)}mutate(){let e=Math.floor(Math.random()*this.chromosome.length),t=Math.floor(Math.random()*this.chromosome.length);[this.chromosome[e],this.chromosome[t]]=[this.chromosome[t],this.chromosome[e]],this.fitness=this.calculateFitness()}constructor(e){this.chromosome=e,this.fitness=this.calculateFitness()}};let Population=class Population{selectParent(){return this.individuals[Math.floor(Math.random()*this.individuals.length)]}evolve(){let e=[];for(e.push(this.getFittest());e.length<this.individuals.length;){let t=this.selectParent(),s=this.selectParent(),n=Individual.crossover(t,s);.1>Math.random()&&n.mutate(),e.push(n)}this.individuals=e}getFittest(){let e=this.individuals[0];for(let t=1;t<this.individuals.length;t++)this.individuals[t].fitness>e.fitness&&(e=this.individuals[t]);return e}constructor(t){this.individuals=[];for(let s=0;s<t;s++){let t=Array.from({length:e.length},(e,t)=>t);t.sort(()=>Math.random()-.5),this.individuals.push(new Individual(t))}}};let t=new Population(50);for(let e=0;e<100;e++)t.evolve();let s=t.getFittest();return console.log("Best Route:",s.chromosome),console.log("Total Distance:",1/s.fitness),s.chromosome}function calculateDistance(e,t){let s=e.lat,n=e.lng,l=t.lat,a=t.lng,o=Math.PI*l/180-Math.PI*s/180,i=Math.PI*a/180-Math.PI*n/180;return Math.sqrt(o*o+i*i)}function createDistanceMatrix(e){let t=[];for(let s=0;s<e.length;s++){let n=e[s],l=[];for(let t=0;t<e.length;t++){let s=e[t],a=calculateDistance(n.location,s.location);l.push(a)}t.push(l)}return t}function useRecommendedPath(e){let t=(0,o.useMemo)(()=>createDistanceMatrix(e),[e]),s=(0,o.useMemo)(()=>0===e.length?[]:evolveOnDistances(t),[t,e.length]);return{bestRoute:s,distanceMatrix:t}}var r=s(20848);let d=s(92798);function useTodo(){let[e,t]=(0,o.useState)(d),s=(0,o.useCallback)(s=>{let n=[...e,{...s,id:(0,r.Z)()}];t(n)},[e]),n=(0,o.useCallback)(s=>{let n=e.filter(e=>e.id!==s.id);t(n)},[e]),l=(0,o.useCallback)(s=>{let{id:n}=s,l=e.filter(e=>e.id!==n);t([...l,s])},[e]);return{todos:e,remove:n,add:s,edit:l}}var h=s(16691),u=s.n(h),m=s(392);function Authentication(e){let{onClick:t}=e;return(0,n.jsx)("div",{className:"w-1/4",children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(u(),{width:128,height:128,className:"h-32 w-32 rounded-full border-4 border-white dark:border-gray-800 mx-auto my-4",src:"https://www.lego.com/cdn/cs/set/assets/blta636ffccc87fdf4b/60367.png?format=webply&fit=bounds&quality=75&width=1200&height=1200&dpr=1",alt:""}),(0,n.jsxs)("button",{onClick:t,type:"button",className:"text-white w-full bg-[#4285F4] hover:bg-[#4285F4]/90 focus:ring-4 focus:outline-none focus:ring-[#4285F4]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center justify-between dark:focus:ring-[#4285F4]/55 mr-2 mb-2",children:[(0,n.jsx)("svg",{className:"mr-2 -ml-1 w-4 h-4","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"google",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 488 512",children:(0,n.jsx)("path",{fill:"currentColor",d:"M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"})}),"Sign in with Google",(0,n.jsx)("div",{})]})]})})}var x=s(58769),f=s(47612),j=s(69008),g=s(65421),p=s(37292),v=s(13234),b=s(77832),Z=s(11275),w=s(70057),k=s(65571),N=s(99869),C=s(80513),S=s(99451),y=s(20951),M=s(82630),T=s(75335),D=s(66134);let P={done:"emerald",todo:"rose",scheduled:"yellow"};function Header(e){let{user:t,todos:s,onSignOut:l}=e;return(0,o.useMemo)(()=>s.map(e=>({color:P[e.status],tooltip:"".concat(e.description," - ").concat(e.status)})),[s]),(0,o.useMemo)(()=>s.filter(e=>"done"!==e.status).length/s.length*100,[s]),(0,n.jsxs)(D.Z,{flexDirection:"row",className:"mb-4 p-5",children:[(0,n.jsxs)(M.Z,{children:["Welcome, ",t.displayName]}),(0,n.jsx)(T.Z,{variant:"secondary",onClick:l,children:"Sign Out"})]})}var I=s(90189);function Status(e){let{status:t}=e,s=(0,o.useMemo)(()=>"scheduled"===t?"yellow":"done"===t?"green":"todo"===t?"orange":void 0,[t]);return(0,n.jsx)(I.Z,{color:s,children:t})}function Task(e){let{todo:t}=e;return(0,n.jsx)("li",{children:(0,n.jsxs)("div",{className:"relative pb-8",children:[(0,n.jsx)("span",{className:"absolute left-5 -ml-px h-full w-0.5 bg-gray-200","aria-hidden":"true"}),(0,n.jsxs)("div",{className:"relative flex items-start space-x-3",children:[(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"relative px-1",children:(0,n.jsx)("div",{className:"h-8 w-8 bg-blue-500 rounded-full ring-8 ring-white flex items-center justify-center",children:(0,n.jsx)("svg",{className:"text-white h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})}),(0,n.jsx)("div",{className:"min-w-0 flex-1 py-0",children:(0,n.jsxs)("div",{className:"text-md text-gray-500",children:[(0,n.jsxs)(D.Z,{flexDirection:"row",children:[(0,n.jsx)(M.Z,{className:"mr-2",children:t.description}),(0,n.jsx)(Status,{status:t.status})]}),(0,n.jsx)("span",{className:"whitespace-nowrap text-sm",children:"".concat(t.location.lat,", ").concat(t.location.lng)})]})})]})]})})}function RecommendedPath(e){let{todos:t,recommendedOrder:s}=e;return(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(M.Z,{children:"Recommended Order"}),(0,n.jsx)("div",{className:"max-w-xl mx-auto p-8",children:(0,n.jsx)("div",{className:"flow-root",children:(0,n.jsx)("ul",{className:"-mb-8",children:s.map((e,s)=>(0,n.jsx)(Task,{todo:t[e]},s))})})})]})}var F=s(59382),R=s(76033),_=s(33622),E=s(74776),L=s(53415),O=s(72950);function task_Task(e){let{latlng:t,setPrompt:s,defaultTaskName:l,prompt:a,onSubmit:i,defaultStatus:c="todo",defaultDescription:r="",title:d,id:h}=e,[u,x]=(0,o.useState)(r),[f,j]=(0,o.useState)(c),g=(0,o.useCallback)(()=>{let e={id:h,description:u,status:f,location:{lat:null==t?void 0:t.lat,lng:null==t?void 0:t.lng}};i(e),s(!1)},[h,u,f,null==t?void 0:t.lat,null==t?void 0:t.lng,i,s]),p="".concat(null==t?void 0:t.lat,", ").concat(null==t?void 0:t.lng);return a?(0,n.jsx)("div",{id:"loading-overlay",className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-60",style:{zIndex:9e3},children:(0,n.jsxs)(m.Z,{className:"w-1/2",children:[(0,n.jsxs)(D.Z,{flexDirection:"row",className:"w-full mb-6",children:[(0,n.jsx)(M.Z,{children:d}),(0,n.jsx)(R.Z,{icon:F.Z,className:"self-end hover:cursor-pointer",onClick:()=>s(!1)})]}),(0,n.jsx)(O.Z,{name:"description",placeholder:"Description (Task Name)",defaultValue:l,className:"mb-2",onValueChange:x}),t&&(0,n.jsx)(O.Z,{name:"latlng",placeholder:"LatLng",value:p,disabled:!0,className:"mb-1"}),(0,n.jsx)(L.Z,{className:"mb-2",children:"Location is not editable. Use the map view to create a new todo."}),(0,n.jsxs)(_.Z,{defaultValue:c||"todo",className:"mb-6",onValueChange:j,children:[(0,n.jsx)(E.Z,{value:"todo",children:"Todo"}),(0,n.jsx)(E.Z,{value:"scheduled",children:"Scheduled"}),(0,n.jsx)(E.Z,{value:"done",children:"Done"})]}),(0,n.jsx)(D.Z,{flexDirection:"row",className:"w-full justify-end",children:(0,n.jsx)(T.Z,{variant:"primary",className:"p-2",onClick:g,children:"Confirm"})})]})}):null}function useReverseGeocode(e){let[t,s]=(0,o.useState)("".concat(e.lat,", ").concat(e.lng));return(0,o.useEffect)(()=>{fetch("https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=".concat(e.lat,"&lon=").concat(e.lng),{method:"GET",headers:{"User-Agent":"Travelling Salesman Problem"}}).then(async e=>{let t=await e.json();s(t.display_name)}).catch(e=>{console.error("something went wrong")})},[e.lat,e.lng]),t}var A=s(31851),G=s(75646),z=s(63326),H=s(68938),V=s(30283),B=s(56760),J=s(97549),q=s(26443);function Row(e){let{todo:t,remove:s,idx:l,edit:a}=e,o=useReverseGeocode(t.location);return(0,n.jsxs)(B.Z,{children:[(0,n.jsx)(z.Z,{children:t.description}),(0,n.jsx)(z.Z,{className:"truncate",children:o}),(0,n.jsx)(z.Z,{children:(0,n.jsx)(Status,{status:t.status})}),(0,n.jsx)(z.Z,{children:(0,n.jsxs)(D.Z,{flexDirection:"row",justifyContent:"start",children:[(0,n.jsx)(T.Z,{icon:J.Z,variant:"light",size:"xs",onClick:()=>a(t),className:"mr-5",children:"Edit"}),(0,n.jsx)(T.Z,{icon:q.Z,variant:"light",size:"xs",onClick:()=>s(t),children:"Delete"})]})})]},l)}function TodosList(e){let{todos:t,remove:s,edit:l}=e;return(0,n.jsxs)(A.Z,{children:[(0,n.jsx)(H.Z,{children:(0,n.jsxs)(B.Z,{children:[(0,n.jsx)(V.Z,{children:"Description"}),(0,n.jsx)(V.Z,{children:"Location"}),(0,n.jsx)(V.Z,{children:"Status"}),(0,n.jsx)(V.Z,{children:"Control"})]})}),(0,n.jsx)(G.Z,{children:t.map((e,t)=>(0,n.jsx)(Row,{todo:e,idx:t,remove:s,edit:l},t))})]})}var W=s(28811),U=s.n(W);let K=U()(()=>Promise.all([s.e(212),s.e(22)]).then(s.bind(s,45022)),{loadableGenerated:{webpack:()=>[45022]},loading:()=>(0,n.jsx)("p",{children:"Loading"}),ssr:!1});function Main(){let[e,t]=(0,o.useState)(!1),[s,l]=(0,o.useState)(!1),{user:a,signInWithGoogle:i,initialise:c,signOutFromApp:r}=useAuthentication(),[d,h]=(0,o.useState)(void 0),{todos:u,remove:T,add:D,edit:P}=useTodo(),[I,F]=(0,o.useState)(void 0);(0,o.useEffect)(()=>{c()},[c]);let R=(0,o.useMemo)(()=>({lat:-36.877765266887586,lng:174.7519683837891}),[]),_=(0,o.useCallback)(e=>{t(!0),h(e)},[]),E=(0,o.useCallback)(e=>{F(e),l(!0)},[]),{bestRoute:L}=useRecommendedPath(u),O=(0,o.useMemo)(()=>[{name:"Todo",count:u.filter(e=>"todo"===e.status).length},{name:"Scheduled",count:u.filter(e=>"scheduled"===e.status).length},{name:"Done",count:u.filter(e=>"done"===e.status).length}],[u]);return a?(0,n.jsxs)("main",{className:"flex min-h-screen flex-col p-6",children:[(0,n.jsx)(task_Task,{title:"Create a new task",latlng:d,setPrompt:t,prompt:e,defaultTaskName:"New Task",onSubmit:D}),I&&(0,n.jsx)(task_Task,{title:"Edit task",latlng:I.location,setPrompt:l,prompt:s,defaultTaskName:null==I?void 0:I.description,defaultStatus:I.status,onSubmit:P,id:I.id}),(0,n.jsx)(Header,{user:a,todos:u,onSignOut:r}),(0,n.jsx)(m.Z,{children:(0,n.jsxs)(N.Z,{children:[(0,n.jsxs)(C.Z,{className:"mt-2",children:[(0,n.jsx)(k.Z,{icon:x.Z,children:"Insights"}),(0,n.jsx)(k.Z,{icon:f.Z,children:"Map"}),(0,n.jsx)(k.Z,{icon:j.Z,children:"Todos List"})]}),(0,n.jsxs)(y.Z,{className:"p-4",children:[(0,n.jsx)(S.Z,{children:(0,n.jsxs)(b.Z,{numItems:12,className:"gap-6",children:[(0,n.jsx)(p.Z,{numColSpan:4,children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(Status,{status:"todo"}),(0,n.jsx)(Z.Z,{children:O[0].count})]})}),(0,n.jsx)(p.Z,{numColSpan:4,children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(Status,{status:"scheduled"}),(0,n.jsx)(Z.Z,{children:O[1].count})]})}),(0,n.jsx)(p.Z,{numColSpan:4,children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(Status,{status:"done"}),(0,n.jsx)(Z.Z,{children:O[2].count})]})}),(0,n.jsx)(p.Z,{numColSpan:4,children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(M.Z,{className:"mb-6",children:"Status Distribution"}),(0,n.jsx)(v.Z,{data:O,variant:"pie",index:"name",category:"count",colors:["yellow","orange","green"],showAnimation:!0,animationDuration:1500})]})}),(0,n.jsx)(p.Z,{numColSpan:5,children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(M.Z,{className:"mb-6",children:"Status Count"}),(0,n.jsx)(g.Z,{data:O,index:"name",categories:["count"],showAnimation:!0,animationDuration:1500})]})}),(0,n.jsx)(p.Z,{numColSpan:3,children:(0,n.jsx)(RecommendedPath,{todos:u,recommendedOrder:L})})]})}),(0,n.jsxs)(S.Z,{children:[(0,n.jsx)(M.Z,{children:"Todos Map View"}),(0,n.jsx)(w.Z,{className:"mb-6",children:"Click on a location in the map to add a new todo."}),(0,n.jsx)(K,{position:R,zoom:12,todos:u,onClick:_})]}),(0,n.jsx)(S.Z,{children:(0,n.jsx)(TodosList,{todos:u,remove:T,edit:E})})]})]})})]}):(0,n.jsx)("main",{className:"flex min-h-screen flex-col p-6 justify-center align-middle place-items-center",children:(0,n.jsx)(Authentication,{onClick:i})})}function Home(){return(0,n.jsx)(Main,{})}},92798:function(e){"use strict";e.exports=JSON.parse('[{"id":"a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11","description":"Task 1","location":{"lat":-36.8485,"lng":174.7633},"status":"todo"},{"id":"b6d0e4e9-ff39-4df7-a7cb-4f6efcb3a8de","description":"Task 2","location":{"lat":-36.8625,"lng":174.5856},"status":"done"},{"id":"b5a1e8a0-5b6c-43d3-8845-d3449b4008b9","description":"Task 3","location":{"lat":-36.8485,"lng":174.7437},"status":"scheduled"},{"id":"b11a9dbf-c07e-40e1-94f4-7b5d96f4d18e","description":"Task 4","location":{"lat":-36.86,"lng":174.7572},"status":"done"},{"id":"c01c52e8-20fd-474f-9b3a-7d83673beba1","description":"Task 5","location":{"lat":-36.8485,"lng":174.7625},"status":"todo"},{"id":"f51c4720-2072-4bcb-a514-7b97f5fd5aa9","description":"Task 6","location":{"lat":-36.8755,"lng":174.7794},"status":"scheduled"},{"id":"f1903f5d-69b0-4c6d-bf5c-597de90fb392","description":"Task 7","location":{"lat":-36.8485,"lng":174.7794},"status":"done"},{"id":"a4f6a418-0987-45c1-b0f2-5c43b4d3c971","description":"Task 8","location":{"lat":-36.8708,"lng":174.7544},"status":"todo"},{"id":"c1dc61ff-8c7a-4560-949f-3a2962185eef","description":"Task 9","location":{"lat":-36.8841,"lng":174.768},"status":"scheduled"},{"id":"e8d1a1f7-c882-402b-918f-b54ef5731cbf","description":"Task 10","location":{"lat":-36.8471,"lng":174.7653},"status":"done"}]')}},function(e){e.O(0,[220,305,971,472,744],function(){return e(e.s=57103)}),_N_E=e.O()}]);